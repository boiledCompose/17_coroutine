## 작업

`launch()` 함수로 코루틴을 실행하면 `Job`인스턴스가 반환된다.

`Job`은 코루틴에 대한 핸들링 또는 참조를 보유하고 코루틴의 수명 주기를 관리할 수 있다.

```kotlin
val job = launch { ... }
```

작업은 코루틴의 수명 주기 또는 지속 시간을 제어하는 데 사용할 수 있다. (예: 작업이 필요하지 않은 경우 코루틴을 취소)
```kotlin
job.cancel()
```

작업을 사용해 코루틴의 활성, 취소, 완료 등의 상태를 확인할 수 있다. 또한 코루틴 간의 상위-하위 관계를 추적한다.

### 작업 계층 구조

코루틴이 다른 코루틴을 실행할 때 새 코루틴에서 반환되는 작업을 **원래 상위 작업의 하위 요소(작업)** 라고 한다. 

이 상위-하위 관계는 하위 요소와 상위 요소 및 동일한 상위 요소에 속한 다른 하위 요소의 특정 동작을 지정하므로 중요하다.

- 상위 작업이 취소되면 그 하위 작업도 취소된다.
- 하위 작업이 취소돼도 그 상위 작업은 취소되지 않는다.
- 하위 작업이 예외와 함께 실패하면 이 예외로 상위 항목이 취소된다. ***(오류 상향 전파)***

<br>

## CoroutineScope

코루틴이 일반적으로 `CoroutineScope`로 실행된다. 이렇게 하면 코루틴이 관리되지 않아 손실되는 일이 없고 리소스 낭비를 방지한다.
`launch()`와 `async()`는 `CoroutineScope`의 확장 함수이다.

`CoroutineScope`는 수명 주기와 연결되어 범위 내의 코루틴이 유지되는 기간에 경계를 설정한다.

- 범위(Scope)가 취소되면 작업이 취소되고, 취소가 하위 요소들에게 전파된다.
- 범위 내의 하위 작업이 예외와 함께 실패하면 상위 작업에 예외가 전파되면서 다른 하위 작업들과 함께 취소된다.
- 상위 작업이 예외와 함께 취소되면 호출자에 예외가 다시 발생한다.

<br>

## CoroutineContext

`CoroutineContext`는 코루틴이 실행될 `Context`에 관한 정보를 제공한다.

`CoroutineContext`는 본질적으로 각 요소에 고유한 키가 있는 요소를 저장하는 맵이며, 필수 필드는 아니지만 다음과 같은 항목을 컨텍스트에 포함한다:

- 이름: 코루틴 고유 식별자
- 작업: 코루틴 수명 주기 제어용
- 디스패처: 스레드에 작업 분배
- 예외 핸들러: 코루틴 코드에서 발생하는 예외 처리

`Context`의 각 요소는 `+` 연산자로 추가될 수 있다.
```kotlin
val coroutineContext:CoroutineContext = Job() + Dispatchers.Main + exceptionHandler
```

코루틴 내에서 새로운 코루틴을 실행하는 경우 하위 코루틴은 상위 코루틴의 `CoroutineContext`를 상속받는다.
직접 지정하고 싶은 경우, 따로 정의하거나 `launch()`와 `async()`에 인수를 전달하면 된다.
```kotlin
scope.launch(Dispatcher.Default)
```

